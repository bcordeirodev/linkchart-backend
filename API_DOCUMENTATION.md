# üìö Link Charts API - Documenta√ß√£o Completa

## üöÄ Introdu√ß√£o

A **Link Charts API** √© uma API RESTful completa para gerenciamento de links encurtados com recursos avan√ßados de analytics, autentica√ß√£o JWT e rate limiting.

### üîó URLs Base
- **Desenvolvimento:** `http://localhost:8000/api`
- **Produ√ß√£o:** `https://api.linkcharts.com`

### üìã Caracter√≠sticas Principais
- ‚úÖ **Autentica√ß√£o JWT** segura
- ‚úÖ **Rate Limiting** inteligente
- ‚úÖ **Analytics avan√ßados** com m√©tricas detalhadas
- ‚úÖ **Par√¢metros UTM** para tracking de campanhas
- ‚úÖ **Links com expira√ß√£o** e ativa√ß√£o programada
- ‚úÖ **Auditoria completa** de todas as opera√ß√µes
- ‚úÖ **Documenta√ß√£o OpenAPI/Swagger**

---

## üîê Autentica√ß√£o

### Como Autenticar

1. **Registre-se** ou fa√ßa **login** para obter um token JWT
2. **Inclua o token** no header de todas as requisi√ß√µes protegidas:

```bash
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
```

### Endpoints de Autentica√ß√£o

#### üìù Registrar Usu√°rio
```http
POST /auth/register
Content-Type: application/json

{
  "name": "Jo√£o Silva",
  "email": "joao@exemplo.com",
  "password": "senha123",
  "password_confirmation": "senha123"
}
```

#### üîë Login
```http
POST /auth/login
Content-Type: application/json

{
  "email": "joao@exemplo.com",
  "password": "senha123"
}
```

#### üîë Login com Google
```http
POST /auth/google
Content-Type: application/json

{
  "token": "ya29.a0ARrdaM9..."
}
```

#### üë§ Dados do Usu√°rio
```http
GET /me
Authorization: Bearer {token}
```

#### üö™ Logout
```http
POST /logout
Authorization: Bearer {token}
```

---

## üîó Gerenciamento de Links

### ‚ûï Criar Link Encurtado

**Endpoint:** `POST /gerar-url`  
**Rate Limit:** 30 requisi√ß√µes/minuto  
**Autentica√ß√£o:** Obrigat√≥ria

#### Exemplo B√°sico
```http
POST /gerar-url
Authorization: Bearer {token}
Content-Type: application/json

{
  "original_url": "https://www.exemplo.com/pagina-muito-longa"
}
```

#### Exemplo Avan√ßado
```http
POST /gerar-url
Authorization: Bearer {token}
Content-Type: application/json

{
  "original_url": "https://www.exemplo.com/produto/123",
  "title": "Produto Especial",
  "description": "Oferta limitada do nosso produto especial",
  "slug": "produto-especial",
  "expires_at": "2024-12-31T23:59:59Z",
  "starts_in": "2024-01-01T00:00:00Z",
  "is_active": true,
  "utm_source": "newsletter",
  "utm_medium": "email",
  "utm_campaign": "black-friday",
  "utm_term": "desconto",
  "utm_content": "botao-principal"
}
```

#### Resposta de Sucesso
```json
{
  "message": "Link criado com sucesso",
  "data": {
    "id": 123,
    "slug": "produto-especial",
    "original_url": "https://www.exemplo.com/produto/123",
    "shorted_url": "https://linkcharts.com/r/produto-especial",
    "title": "Produto Especial",
    "description": "Oferta limitada do nosso produto especial",
    "clicks": 0,
    "is_active": true,
    "expires_at": "2024-12-31T23:59:59Z",
    "created_at": "2024-01-15T10:30:00Z"
  }
}
```

### üìã Listar Links

**Endpoint:** `GET /link`  
**Autentica√ß√£o:** Obrigat√≥ria

#### Par√¢metros de Query
- `page` - N√∫mero da p√°gina (padr√£o: 1)
- `per_page` - Itens por p√°gina (padr√£o: 15, m√°ximo: 100)
- `search` - Buscar por t√≠tulo, URL ou slug
- `status` - Filtrar por status (`active`, `inactive`, `all`)

#### Exemplo
```http
GET /link?page=1&per_page=10&search=produto&status=active
Authorization: Bearer {token}
```

### üîç Obter Link Espec√≠fico

**Endpoint:** `GET /link/{id}`  
**Autentica√ß√£o:** Obrigat√≥ria

```http
GET /link/123
Authorization: Bearer {token}
```

### ‚úèÔ∏è Atualizar Link

**Endpoint:** `PUT /link/{id}`  
**Rate Limit:** 20 requisi√ß√µes/minuto  
**Autentica√ß√£o:** Obrigat√≥ria

```http
PUT /link/123
Authorization: Bearer {token}
Content-Type: application/json

{
  "title": "Novo T√≠tulo",
  "description": "Nova descri√ß√£o",
  "is_active": false,
  "expires_at": "2024-06-30T23:59:59Z"
}
```

### üóëÔ∏è Excluir Link

**Endpoint:** `DELETE /link/{id}`  
**Rate Limit:** 20 requisi√ß√µes/minuto  
**Autentica√ß√£o:** Obrigat√≥ria

```http
DELETE /link/123
Authorization: Bearer {token}
```

### üìú Hist√≥rico de Auditoria

**Endpoint:** `GET /link/{id}/audit`  
**Autentica√ß√£o:** Obrigat√≥ria

```http
GET /link/123/audit
Authorization: Bearer {token}
```

---

## üìä Analytics

### üìà Analytics Gerais

**Endpoint:** `GET /analytics`  
**Autentica√ß√£o:** Obrigat√≥ria

#### Par√¢metros de Query
- `period` - Per√≠odo (`today`, `week`, `month`, `year`, `all`)
- `start_date` - Data in√≠cio (YYYY-MM-DD)
- `end_date` - Data fim (YYYY-MM-DD)

```http
GET /analytics?period=month
Authorization: Bearer {token}
```

#### Resposta
```json
{
  "total_links": 25,
  "total_clicks": 5420,
  "active_links": 23,
  "avg_clicks_per_link": 216.8,
  "top_links": [
    {
      "id": 123,
      "title": "Meu Link Popular",
      "slug": "meu-link-popular",
      "clicks_count": 892,
      "original_url": "https://exemplo.com"
    }
  ],
  "recent_clicks": [
    {
      "date": "2024-01-15",
      "total": 156
    }
  ],
  "clicks_by_country": [
    {
      "country": "Brasil",
      "total": 2340
    }
  ],
  "clicks_by_device": [
    {
      "device": "mobile",
      "total": 3250
    }
  ]
}
```

### üéØ Analytics de Link Espec√≠fico

**Endpoint:** `GET /link/{slug}/analytics`  
**Autentica√ß√£o:** Obrigat√≥ria

```http
GET /link/meu-link/analytics?start_date=2024-01-01&end_date=2024-01-31
Authorization: Bearer {token}
```

---

## üîÑ Redirecionamento

### üåê Redirecionar Link (P√∫blico)

**Endpoint:** `GET /r/{slug}`  
**Autentica√ß√£o:** N√£o requerida

Este endpoint √© usado para o redirecionamento real dos links encurtados. Ele:

1. ‚úÖ Registra o clique com dados do visitante
2. ‚úÖ Verifica se o link est√° ativo
3. ‚úÖ Verifica se o link n√£o expirou
4. ‚úÖ Redireciona para a URL original

```http
GET /r/meu-link-especial
```

#### Par√¢metros UTM Adicionais
Voc√™ pode adicionar par√¢metros UTM extras na URL:

```http
GET /r/meu-link?utm_source=facebook&utm_campaign=post-especial
```

#### Respostas
- **302** - Redirecionamento para URL original
- **404** - Link n√£o encontrado ou inativo
- **410** - Link expirado

### üîç Obter Info do Link (P√∫blico)

**Endpoint:** `GET /link/by-slug/{slug}`  
**Autentica√ß√£o:** N√£o requerida

```http
GET /link/by-slug/meu-link
```

---

## ‚ö° Rate Limiting

A API implementa rate limiting para proteger contra abuso:

| Endpoint | Limite | Janela |
|----------|--------|--------|
| `POST /gerar-url` | 30 requisi√ß√µes | 1 minuto |
| `PUT /link/{id}` | 20 requisi√ß√µes | 1 minuto |
| `DELETE /link/{id}` | 20 requisi√ß√µes | 1 minuto |
| Outros endpoints | Sem limite espec√≠fico | - |

### Headers de Rate Limit
```http
X-RateLimit-Limit: 30
X-RateLimit-Remaining: 25
X-RateLimit-Reset: 1640995200
```

### Resposta de Limite Excedido
```json
{
  "error": "Rate limit exceeded",
  "message": "Muitas tentativas. Tente novamente em alguns minutos.",
  "retry_after": 60
}
```

---

## üö® C√≥digos de Status

| C√≥digo | Significado | Descri√ß√£o |
|--------|-------------|-----------|
| **200** | ‚úÖ OK | Requisi√ß√£o bem-sucedida |
| **201** | ‚úÖ Created | Recurso criado com sucesso |
| **400** | ‚ùå Bad Request | Erro na requisi√ß√£o |
| **401** | üîê Unauthorized | Token n√£o fornecido ou inv√°lido |
| **403** | üö´ Forbidden | Acesso negado |
| **404** | üîç Not Found | Recurso n√£o encontrado |
| **410** | ‚è∞ Gone | Recurso expirado |
| **422** | ‚ùå Validation Error | Erro de valida√ß√£o de dados |
| **429** | ‚è±Ô∏è Too Many Requests | Rate limit excedido |
| **500** | üí• Internal Error | Erro interno do servidor |

---

## üìù Exemplos de Uso

### üîÑ Fluxo Completo: Criar e Gerenciar Link

```bash
# 1. Registrar usu√°rio
curl -X POST http://localhost:8000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Jo√£o Silva",
    "email": "joao@exemplo.com",
    "password": "senha123",
    "password_confirmation": "senha123"
  }'

# 2. Fazer login
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "joao@exemplo.com",
    "password": "senha123"
  }'

# Resposta: { "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..." }

# 3. Criar link encurtado
curl -X POST http://localhost:8000/api/gerar-url \
  -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..." \
  -H "Content-Type: application/json" \
  -d '{
    "original_url": "https://www.meusite.com/produto/123",
    "title": "Produto Incr√≠vel",
    "utm_source": "newsletter",
    "utm_campaign": "promocao-janeiro"
  }'

# 4. Listar links
curl -X GET http://localhost:8000/api/link \
  -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."

# 5. Ver analytics
curl -X GET http://localhost:8000/api/analytics?period=month \
  -H "Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
```

### üìä Monitoramento de Performance

```javascript
// Exemplo em JavaScript para monitorar cliques
const monitorLink = async (slug) => {
  try {
    const response = await fetch(`/api/link/${slug}/analytics`, {
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      }
    });
    
    const analytics = await response.json();
    
    console.log(`Total de cliques: ${analytics.total_clicks}`);
    console.log(`Visitantes √∫nicos: ${analytics.unique_visitors}`);
    console.log(`M√©dia di√°ria: ${analytics.avg_daily_clicks}`);
    
    return analytics;
  } catch (error) {
    console.error('Erro ao obter analytics:', error);
  }
};
```

### üéØ Tracking UTM Avan√ßado

```bash
# Criar link com par√¢metros UTM completos
curl -X POST http://localhost:8000/api/gerar-url \
  -H "Authorization: Bearer {token}" \
  -H "Content-Type: application/json" \
  -d '{
    "original_url": "https://loja.exemplo.com/produto/smartphone",
    "title": "Smartphone em Promo√ß√£o",
    "slug": "smartphone-promo",
    "utm_source": "facebook",
    "utm_medium": "social",
    "utm_campaign": "black-friday-2024",
    "utm_term": "smartphone-desconto",
    "utm_content": "post-feed"
  }'

# Link gerado: https://linkcharts.com/r/smartphone-promo
# Ao clicar, redireciona para:
# https://loja.exemplo.com/produto/smartphone?utm_source=facebook&utm_medium=social&utm_campaign=black-friday-2024&utm_term=smartphone-desconto&utm_content=post-feed
```

---

## üõ†Ô∏è Ferramentas e Recursos

### üìñ Documenta√ß√£o Interativa

A documenta√ß√£o completa est√° dispon√≠vel em formato **OpenAPI/Swagger**:

- **Arquivo:** [`api-documentation.yaml`](./api-documentation.yaml)
- **Swagger UI:** Importe o arquivo YAML em https://editor.swagger.io
- **Postman:** Importe a cole√ß√£o gerada para testes

### üß™ Cole√ß√£o do Postman

```json
{
  "info": {
    "name": "Link Charts API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000/api"
    },
    {
      "key": "token",
      "value": ""
    }
  ]
}
```

### üîç Testes Automatizados

```bash
# Instalar depend√™ncias de teste
npm install -g newman

# Executar testes da API
newman run link-charts-api.postman_collection.json \
  --environment link-charts.postman_environment.json
```

---

## üöÄ Pr√≥ximos Recursos

### üîÑ Em Desenvolvimento
- [ ] **Webhooks** para notifica√ß√µes em tempo real
- [ ] **Bulk operations** via API
- [ ] **API versioning** (v2)
- [ ] **GraphQL endpoint**
- [ ] **M√©tricas em tempo real** via WebSockets

### üí° Roadmap Futuro
- [ ] **Integra√ß√£o com Google Analytics**
- [ ] **A/B testing** para links
- [ ] **Geolocaliza√ß√£o avan√ßada**
- [ ] **API de relat√≥rios customizados**
- [ ] **SDK oficial** para JavaScript/Python

---

## üìû Suporte

### üÜò Precisa de Ajuda?

- **üìß Email:** support@linkcharts.com
- **üìö Documenta√ß√£o:** https://docs.linkcharts.com
- **üêõ Issues:** https://github.com/linkcharts/api/issues
- **üí¨ Discord:** https://discord.gg/linkcharts

### ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas! Por favor:

1. Fork o reposit√≥rio
2. Crie uma branch para sua feature
3. Fa√ßa commit das mudan√ßas
4. Abra um Pull Request

---

## üìÑ Licen√ßa

Este projeto est√° licenciado sob a **MIT License** - veja o arquivo [LICENSE](LICENSE) para detalhes.

---

**üéâ Pronto para come√ßar? Fa√ßa seu primeiro request e comece a encurtar links como um profissional!**
